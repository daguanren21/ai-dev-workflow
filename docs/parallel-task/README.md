# 并行任务框架

> 通用的 AI 辅助开发并行任务框架，适用于任何前端/后端项目。

---

## 架构概览

```
┌─────────────────────────────────────────────────────────────────┐
│                        AI 编码工具层                             │
│         (Claude Code / Codex / Kiro / Qodo / Cursor)            │
└─────────────────────────────┬───────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ↓               ↓               ↓
        ┌──────────┐   ┌──────────┐   ┌──────────┐
        │CLAUDE.md │   │AGENTS.md │   │.kiro/    │
        │(Claude)  │   │(通用)    │   │steering/ │
        └────┬─────┘   └────┬─────┘   └────┬─────┘
              └───────────────┼───────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                    docs/parallel-task/                          │
│                      (核心规范层)                                │
│                    唯一真相源 (SSOT)                             │
└─────────────────────────────────────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ↓               ↓               ↓
        ┌──────────┐   ┌──────────┐   ┌──────────┐
        │ MCP层    │   │ Skills层 │   │ 适配层   │
        │需求获取   │   │技能匹配   │   │Mock/API │
        └──────────┘   └──────────┘   └──────────┘
```

## 设计原则

| 原则 | 说明 |
|-----|------|
| **Fan-out/Fan-in** | 任务分发与结果聚合模式 |
| **取消机制** | 支持任务组取消和单任务取消 |
| **缓存策略** | 调研任务支持结果缓存复用 |
| **流式处理** | 边执行边汇总 |
| **最大并行度** | ≤5 个并行任务 |
| **SSOT** | `docs/parallel-task/` 是唯一真相源，所有入口文件仅引用 |

## 核心组件

| 组件 | 文件 | 职责 |
|-----|------|------|
| 工作流 | [workflow.md](./workflow.md) | 10 步端到端工作流 |
| 任务类型 | [task-types.md](./task-types.md) | 8 种任务类型 + 调度策略 |
| Service Transform | [service-transform.md](./service-transform.md) | 前后端字段适配方案 |
| 任务模板 | [templates/](./templates/) | 6 种任务声明模板 |

## 快速上手

### 1. 复制框架到项目

```bash
# 将整个 docs/parallel-task/ 目录复制到你的项目
cp -r docs/parallel-task/ <your-project>/docs/parallel-task/
```

### 2. 创建入口文件

根据使用的 AI 工具，创建对应入口文件：

- **Claude Code** → `CLAUDE.md`（使用 `@` 引用）
- **Codex / Qodo / Cursor** → `AGENTS.md`
- **Kiro** → `.kiro/steering/parallel-task.md`

入口文件内容参考项目根目录的模板。

### 3. 配置 MCP Server（可选）

如需自动获取需求，安装 `requirements-mcp-server`：

```json
{
  "mcpServers": {
    "requirements": {
      "command": "npx",
      "args": ["requirements-mcp-server"]
    }
  }
}
```

## 适用场景

- 前端项目（Vue/React/Angular）
- 后端项目（Node.js/Java/Go）
- 全栈项目
- 库/工具项目
